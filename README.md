# KCloud
Targets trio sequencing of same-species crosses.   
Assumes Illumina paired-end RNA-seq data.   
Depends on sequence alignments for assigning reads to genes.   
Depends on k-mer analysis for assigning reads to either parent.   
Uses bam files from e.g. the Bowtie2 sequence aligner.   
Uses samtools to read bam files.   
Uses the k-mer analysis module "meryl" of the Canu genome assembler.  
Generates and uses the meryl.db databases from meryl.   

## ArenosaMS
Our initial dataset. Parents M and S. Crosses MxS and SxM. Four biological replicates. Processed with Slurm on Saga.

### Compute the k-mer clouds
* run_meryl.sh - Count k-mers in one parent.
* run_diff.sh - Retain k-mers specific to one parent.
* run_intersect.sh - Retain k-mers from a cross also specific to one parent.

### Classify reads
* grid_mer_filter.sh - Submit a job to the grid for one biological replicate.
* individual_mer_filter.sh - Launch the Python with 5 parameters.
* mer_filter_reads.py - Stream a pair of fastq files, write a pair of IDs lists, one maternal, one paternal.

### Utilities
* sample_reads.sh - Sample down a pair of fastq files to first 10M read pairs. 
* extract_gene_per_read.sh - Given a bam file, make csv file of "readID,geneID". Assume sorted by readID so second ID can be ignored. Assume bam already filtered to retain end-to-end concordant-pair maps only.
* run_statistics.sh - Count reads assigned to mat and pat. Write to stdout.
* grid_validate.sh - Modified grid_mer_filter.sh used for test runs on partial fastq files generated by sample_reads.


